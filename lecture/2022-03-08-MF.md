---
layout: single
title: 'Recommendation System Matrix Fatorization'
---
# Matrix Fatorization (MF)
- MF 문제 정의
  - SVD의 개념과 유사하나 관측된 선호도만 반영
  - 관측되지 않은 선호도를 예측하는 일반적인 모델을 만드는 것이 목표
  - Rating Matrix를 P와 Q로 분해하고 R과 최대한 유사하게 R_hat을 추론 (최적화)
  - Objective Function
    - 실제 rating과 예측 rating (p*q) 간 차이
    - p 파라미터, q 파라미터 값이 너무 커지지 않도록, regularization 작용을하는 상수배 된 penalty term 존재 (과적합 방지)
    - 실제 관측된 데이터만을 사용
  - Regularization이란?
    - weight를 loss function에 넣어주면 weight가 너무 커지지 않도록 overfitting 방지
- MF 학습
  - Stochastic Gradient Descent
    - Gradient의 반대방향으로 p,q를 업데이트
- 기본적인 MF + alpha
  - Adding Biases
    - 유저나 아이템에 편향이 생길 수 있다
    - 전체 평균, 유저/아이템 별로 bias를 추가
  - Adding Confidence Level
    - 신뢰도의 개념 사용
    - 대규모 광고 집행과 같이 특정 아이템이 많이 노출되거나 / 유저의 아이템에 대한 평점이 정확하지 않은 경우 confidence를 낮게 주어 덜 학습하도록
    - Implicit Feedback
  - Adding Temporal Dynamics
    - 시간에 따라 변하는 특성 반영
    - 시간을 반영한 평점 예측
- MF for Implicit Feedback
  - Alternative Least Square (ALS)
    - P,Q를 동시에 업데이트 하는 것이 아닌 번갈아가며 업데이트
    - 한 쪽의 파라미터를 고정하면 least-square 문제로 풀 수 있다 (목적함수가 quardratic form이 되어 convex하다)
    - SGD보다 더 Robust
    - 대용량 데이터를 병렬 처리하여 빠른 학습이 가능
  - Preference
    - 선호하는지 여부를 binary로 표현
  - Confidence
    - 유저가 아이템을 선호하는 정도를 나타내는 함수
    - positive/negative feedback 간의 상대적인 중요도를 조정하는 alpha 존재
    - rating이 높을수록 크게, 낮을수록 낮게 반영
    - Adding confidence level 방법 참고
  - p,q간 내적 값은 preference를 예측, 둘 간의 차이는 confidence을 통해 목적함수에 얼마나 적용할지 결정
  - SGD나 ALS로 동일하게 풀 수 있다