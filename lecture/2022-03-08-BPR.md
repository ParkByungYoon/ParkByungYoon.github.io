---
layout: single
title: 'Recommendation System Bayesian Personalized Ranking'
---
## Bayesian Personalized Ranking
- Personalized Ranking
  - 사용자에게 순서가 있는 아이템 리스트를 제공
  - item i보다 j를 좋아한다면 이 정보를 사용해 MF의 파라미터를 학습
  - i>j 는 유저의 Personalized Ranking이다
  - 클릭, 구매 등의 로그 (선호 정도가 분명하게 드러나지 X)
    - 관측되지 않은 데이터에 대해 관심 없는가, 실제로 관심이 있지만 아직 모르는건가 이 두가지 모두 고려
- 가정
  - 관측된 item 끼리 / 관측되지 않은 item끼리는 선호도를 추론할 수 없다
  - but 관측된 item을 관측되지 않은 item보다 선호
- 특징
  - 관측되지 않은 item들에 대해서도 정보 부여 가능
  - 즉, 관측되지 않은 item들에 대해서도 ranking이 가능
- 학습 데이터 생성
  - 유저, 관측된 데이터, 관측되지 않은 데이터
  - triples 집합으로 구성
- Maximum A Posterior
  - 사후확률 (posterior)
    - 주어진 유저 선호 정보에 대한 파라미터의 확률
    - 사전확률과 가능도에 비례
    - 주어진 유저 선호 정보를 최대한 잘 나타내는 파라미터를 추정
  - Likelihood 계산
    - 유저 u가 아이템 i보다 j를 선호할 확률을 MF를 통해 표현
    - 0~1사이의 확률값으로 표현하기 위해 sigmoid 함수 사용
    - sigmoid(pq - pq_hat)
  - Prior 계산
    - 파라미터에 대한 사전 확률은 정규분포를 따른다고 가정
    - 공분산 행렬은 계수를 통해 하이퍼파라미터로 조정 가능
  - BPR 목적함수
    - MAP 방향으로 목적함수 설계
    - 미분가능하기 떄문에 Grdient Descent Optimization 수행
    - But 일반적인 Grdient Descent은 옳지 않은 학습방향일 수 있다
  - LEARNBPR
    - Bootstrap 기반의 SGD 사용
    - 일반적인 SGD 사용시
      - 보통 i보다 j가 훨씬 많기 때문에 학습의 비대칭 발생
      - 동일한 u,i가 계속 업데이트
    - triples 단위로 랜덤 샘플링
    - MF를 통해 User/Item parameter를 업데이트!