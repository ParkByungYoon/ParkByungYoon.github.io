## 조건부확률이란?

- 사건 B가 일어난 상황에서 사건 A가 발생활 확률을 의미한다
  - B가 주어졌을 때 A가 일어날 확률을 구한다![jpg](/assets/images/2022-01-11/20220111_193029.jpg)

- 베이즈 정리는 조건부확률을 이용하여 정보를 갱신하는 방법을 알려준다

  - A라는 새로운 정보가 주어졌을 때 P(B)로부터 P(B|A)를 계산하는 방법을 제공

  - theta : 모델에서 계산되는 parameter

  - D : 새로 관찰되는 데이터![jpg](/assets/images/2022-01-11/20220111_193501.jpg)

    - 사후확률(posterior) : 데이터를 관찰했을 때 hypothesis/parameter가 성립할 확률
    - 사전확률(prior) : 데이터가 주어지지 않았을 때 사전에 주어지는 확률
      - 모델링 이전에 사전에 찾아낸 확률 분포
    - 가능도(likelihood) : 현재 파라미터에서 데이터가 관찰될 확률
    - Evidence : 데이터 자체의 분포

  - 베이즈 정리를 통해 사전확률을 사후확률로 업데이트

  - **COVID-99의 발병률** 10%, **실제로 검진될 확률**은 99%, **실제로걸리지 않았을 때 오검진된 확률**이 1%, 그렇다면 **질병에 걸렸다고 검진결과가 나왔을 때 정말로 COVID-99에 감염되었을 확률**은?

    - P(theta) = 0.1 (발병률 == 사전확률)
    - P(D|theta) = 0.99  (실제로 걸렸을 때 검진될 확률)
    - P(D|not theta) = 0.01 (실제로 걸리지 않았을 때 검진될 확률)
    - P(D) = P(D|theta) * P(theta) + P(D|not theta) * P(not theta) = 0.108 (evidence)
    - P(theta|D) = 0.1 * 0.99 / 0.108 = 0.916 (걸렸다는 검진이 나왔을 때 감염되었을 확률)
    - 오검진될 확률이 오를경우 테스트의 정밀도(걸렸다는 검진이 나왔을 때 감염되었을 확률, Precision)가 떨어진다

  - Confusion matrix

    ![jpg](/assets/images/2022-01-11/20220111_204320.jpg)

    - True Positive : 양성이 나왔을 때 실제 양성인 경우
    - True Negative : 음성이 나왔을 때 실제 양성인 경우
    - False alarm (False Positive) : 양성이 나왔을 때 실제 음성인 경우 (1종 오류)
    - False Negative : 음성이 나왔을 때 실제 양성인 경우 (2종 오류)

  - Precision : 양성이라 찍은것 중에 실제 양성인 비율 (오탐과 민감도가 반영되어 구해짐)

  - Recall : 실제 양성인 것 중에 양성이라 찍은 비율 (양성이라 검진되었을 때 실제 양성)

  

## 베이즈를 통한 정보의 갱신

- 베이즈 정리를 이용해 새로운 데이터가 들어왔을 때 앞서 계산한 사후확률을 사전확률로 사용하여 갱신된 사후확률을 계산할 수 있다
- 앞서 COVID-99 판정을 받은 사람이 두 번째 검진을 받았을 때도 양성이 나왔을 때 진짜 COVID-99에 걸렸을 확률은?
  - P(theta) = 0.
  - P(D|theta) = 0.99
  - P(theta|D) = 0.1 * 0.99/0.189 = 0.524
  - P(D') = 0.99 * 0.524 + 0.1 * 0.476 = 0.566 (갱신된 evidence)
  - P(theta|D') = 0.524 * 0.99/0.566 = 0.917 
- 데이터가 새로 들어올 때마다 Precision은 상승, 즉 베이즈 정리를 통해 데이터가 들어올 때마다 사후확률을 업데이트 할 수 있고 유효한 모델링이 가능해진다
- 조건부확률 != 인과관계(causality)
  - 인과관계는 데이터 분포의 변화에 강건한 예측 모형을 만들 때 필요
  - 조건부확률 기반 예측모형의 경우 높은 최대치의 예측 정확도를 보일 수는 있지만 어떤 시나리오에서는 낮은 예측 정확도를 보일 수 있다 반면 인과관계를 도입하면 높은 예측 정확도는 보이기 어렵지만 여러 시나리오에서도 예측 정확도가 크게 변하지 않는 결과를 만들어낼 수 있다.
  - 인과관계를 알아내기 위해서는 두 개의 변수가 있을 경우 두 개의 변수 모두에 영향을 주는 중첩요인을 제거해야 원인에 해당하는 변수만의 인과관계를 계산할 수 있다. (제거 하지 않는다면 spurious correlation이 나온다)
