---
layout: single
title: 'Recommendation System Collaborative Filtering'
categories:
  - boostcamp AI tech
---
# 협업 필터링(Collaborative Filtering, CF)이란?
- 다수의 의견을 활용
- 더 많은 유저/아이템 데이터가 축적될수록 협업의 효과 up
- 내 정보만이 아닌 다른 사람들의 데이터까지 활용
- 유저 u가 아이템 i에 부여할 평점을 예측
  - 주어진 데이터를 통해 유저 아이템 행렬을 생성
  - 유사도 기준을 통해 유저 혹은 아이템 간 유사도를 구함
  - 주어진 평점과 유사도를 활용해 행렬의 비어있는 값을 예측
- 유저와 비슷한 취향을 가진 유저들이 선호하는 아이템을 추천
- Neighborhood-based CF
  - User-based CF
    - 유저 간 유사도를 구한 뒤 타겟과 유사도가 높은 유저들이 선호하는 아이템 추천
  - Item-based CF
    - 아이템간 유사도를 구한뒤 타겟 아이템과 유사도가 높은 아이템 중 선호도가 큰 아이템을 추천
  - 아이템, 유저가 많아질수록 확장성이 떨어진다
  - Sparsity (행렬 대부분의 원소가 비어있음 sparse matrix)
  - sparsity ratio가 99.5%를 넘지 않는게 좋다
- KNN CF
  - NBCF의 한계는 아이템 i에 대해 평가를 한 모든 유저 집합을 사용해 유저가 많아질 경우 계속해서 연산이 늘어난다
  - 이러한 이유로 KNN CF는 타겟 유저와 가장 유사한 K명의 유저만을 이용해 평점을 예측한다
- 유사도 측정법
  - 두 개체 간 유사성을 수량화하는 함수 혹은 척도
  - 일반적으로 거리의 역수 개념을 사용
  - Mean Squared Difference
    - 주어진 유저 또는 아이템 rating에 대해 mean squared difference를 구한다
    - 유클리드 거리에 반비례
    - 분모가 0이 되는 것을 방지하기 위해 분모에 1이 더해진다
  - Cosine Similarity
    - 두 벡터의 차원이 같아야한다
    - 두 벡터가 가리키는 방향이 얼마나 유사한가
  - Pearson Similarity (Pearson Correlation)
    - 각 벡터를 표본평균을 정규화한뒤 코사인 유사도를 구한다
    - 각 벡터에 대한 rating의 크기차이를 고려 가능하다
      - 3.5, 4.5과 같이 평점의 변동 폭이 크지 않은 유저와 1, 5와 같이 평점의 변동 폭이 큰 유저 둘 사이 차이를 보정
  - Jaccard Similarity
    - 집합의 개념을 사용한 유사도
    - 차원이 달라도 이론적으로 유사도 계산이 가능하다
- Absolute Rating
    - Average
      - 유저와 유사한 유저 집합의 평점을 평균
    - Weighted Average
      - 유사도가 높은 유저의 평점을 많이 반영
    - 유저가 평점을 주는 기준이 제각기 다르다는 한계 존재
- Relative Rating
  - 유저의 평균 평점에서 얼마나 높은지 혹은 낮은지, 그 편차를 사용
  - 원래의 rating이 아닌 deviation을 예측
- CF의 최종 목적
  - 유저 u가 아이템 i에 부여할 평점을 예측
- RecSys의 최종 목적
  - 예측 평점이 높은 아이템을 유저에게 추천
  - Top-N Recommendation